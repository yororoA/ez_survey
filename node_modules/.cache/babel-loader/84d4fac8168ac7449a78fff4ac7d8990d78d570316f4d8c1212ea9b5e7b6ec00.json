{"ast":null,"code":"import { getUserData } from \"./getUserData\";\n\n/*查询用户绑定的survey\r\n* @accept`getDrafts:` Bool, 是否获取草稿, false为获取已发布*/\nexport async function getUserSurveys(getDrafts) {\n  // 获取用户数据\n  const data = await getUserData();\n  console.log(data);\n  // 获取草稿\n  if (getDrafts) {\n    const surveys = data.data.surveys.filter(survey => survey.published === false);\n    const surveysDetails = [];\n    for (const survey of surveys) {\n      const detail = await getSurveyQues(survey.id, true);\n      surveysDetails.push(detail);\n    }\n    return surveysDetails;\n  }\n  // 获取已发布\n  const surveys = data.data.surveys.filter(survey => survey.published === true);\n  const surveysDetails = [];\n  for (const survey of surveys) {\n    const detail = await getSurveyQues(survey.id, false);\n    surveysDetails.push(detail);\n  }\n  return surveysDetails;\n}\n\n/* 根据 `surveyId` 查询相应 `survey` 的 `questions`\r\n* @accept `surveyId`: 需要查询的 survey\r\n* @accept `draftsOrPublished`: bool, 是否获取草稿, false为获取已发布 */\nexport async function getSurveyQues(surveyId, draftsOrPublished) {\n  const url = `http://localhost:1337/api/surveys/${surveyId}`;\n  try {\n    const resp = await fetch(url);\n    if (!resp.ok) {\n      throw new Error(`获取数据失败: ${resp.status}`);\n    }\n    const surveyDetails = await resp.json();\n    return draftsOrPublished ? {\n      // 返回草稿问卷相关信息\n      title: surveyDetails.data.title,\n      description: surveyDetails.data.description,\n      id: surveyId,\n      questions: surveyDetails.data.questions\n    } : {\n      // 返回已发布问卷相关信息\n      title: surveyDetails.data.title,\n      description: surveyDetails.data.description,\n      id: surveyId,\n      endCollection: surveyDetails.data.endCollection\n    };\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n}\n\n/* 根据 `questionId` 获取对应的 `questionDetail` */\nexport async function getQueDetails(questionId) {\n  const url = `http://localhost:1337/api/quests/${questionId}`;\n  try {\n    const resp = await fetch(url);\n    if (!resp.ok) {\n      throw new Error(`获取数据失败: ${resp.status}`);\n    }\n    const questionDetails = await resp.json();\n    const questionType = questionDetails.data.type;\n    switch (questionType) {\n      case 'text':\n      case 'location':\n        {\n          return {\n            title: questionDetails.data.title,\n            type: questionType,\n            index: questionDetails.data.index\n          };\n        }\n      case 'single':\n      case 'checkbox':\n        {\n          return {\n            title: questionDetails.data.title,\n            type: questionType,\n            options: questionDetails.data.options,\n            index: questionDetails.data.index\n          };\n        }\n      case 'rating':\n      case 'slider':\n        {\n          return {\n            title: questionDetails.data.title,\n            type: questionType,\n            max: questionDetails.data.max,\n            step: questionDetails.data.step,\n            index: questionDetails.data.index\n          };\n        }\n    }\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n}","map":{"version":3,"names":["getUserData","getUserSurveys","getDrafts","data","console","log","surveys","filter","survey","published","surveysDetails","detail","getSurveyQues","id","push","surveyId","draftsOrPublished","url","resp","fetch","ok","Error","status","surveyDetails","json","title","description","questions","endCollection","err","error","getQueDetails","questionId","questionDetails","questionType","type","index","options","max","step"],"sources":["E:/Desktop/桌面/工作/编程/前端/projext/project/src/utils/getUserSurveys.js"],"sourcesContent":["import {getUserData} from \"./getUserData\";\r\n\r\n/*查询用户绑定的survey\r\n* @accept`getDrafts:` Bool, 是否获取草稿, false为获取已发布*/\r\nexport async function getUserSurveys(getDrafts) {\r\n\t// 获取用户数据\r\n\tconst data = await getUserData();\r\n\tconsole.log(data);\r\n\t// 获取草稿\r\n\tif (getDrafts) {\r\n\t\tconst surveys = data.data.surveys.filter(survey => survey.published === false);\r\n\t\tconst surveysDetails = [];\r\n\t\tfor (const survey of surveys) {\r\n\t\t\tconst detail = await getSurveyQues(survey.id, true);\r\n\t\t\tsurveysDetails.push(detail);\r\n\t\t}\r\n\t\treturn surveysDetails;\r\n\t}\r\n\t// 获取已发布\r\n\tconst surveys = data.data.surveys.filter(survey => survey.published === true);\r\n\tconst surveysDetails = [];\r\n\tfor (const survey of surveys) {\r\n\t\tconst detail = await getSurveyQues(survey.id, false);\r\n\t\tsurveysDetails.push(detail);\r\n\t}\r\n\treturn surveysDetails;\r\n}\r\n\r\n/* 根据 `surveyId` 查询相应 `survey` 的 `questions`\r\n* @accept `surveyId`: 需要查询的 survey\r\n* @accept `draftsOrPublished`: bool, 是否获取草稿, false为获取已发布 */\r\nexport async function getSurveyQues(surveyId, draftsOrPublished) {\r\n\tconst url = `http://localhost:1337/api/surveys/${surveyId}`;\r\n\ttry {\r\n\t\tconst resp = await fetch(url);\r\n\t\tif (!resp.ok) {\r\n\t\t\tthrow new Error(`获取数据失败: ${resp.status}`);\r\n\t\t}\r\n\t\tconst surveyDetails = await resp.json();\r\n\t\treturn draftsOrPublished?{\r\n\t\t\t// 返回草稿问卷相关信息\r\n\t\t\ttitle: surveyDetails.data.title,\r\n\t\t\tdescription: surveyDetails.data.description,\r\n\t\t\tid: surveyId,\r\n\t\t\tquestions: surveyDetails.data.questions\r\n\t\t}:{\r\n\t\t\t// 返回已发布问卷相关信息\r\n\t\t\ttitle: surveyDetails.data.title,\r\n\t\t\tdescription: surveyDetails.data.description,\r\n\t\t\tid: surveyId,\r\n\t\t\tendCollection: surveyDetails.data.endCollection\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tconsole.error(err);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/* 根据 `questionId` 获取对应的 `questionDetail` */\r\nexport async function getQueDetails(questionId) {\r\n\tconst url = `http://localhost:1337/api/quests/${questionId}`;\r\n\ttry {\r\n\t\tconst resp = await fetch(url);\r\n\t\tif (!resp.ok) {\r\n\t\t\tthrow new Error(`获取数据失败: ${resp.status}`);\r\n\t\t}\r\n\t\tconst questionDetails = await resp.json();\r\n\t\tconst questionType = questionDetails.data.type;\r\n\t\tswitch (questionType) {\r\n\t\t\tcase 'text':\r\n\t\t\tcase 'location': {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttitle: questionDetails.data.title,\r\n\t\t\t\t\ttype: questionType,\r\n\t\t\t\t\tindex: questionDetails.data.index\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tcase 'single':\r\n\t\t\tcase 'checkbox': {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttitle: questionDetails.data.title,\r\n\t\t\t\t\ttype: questionType,\r\n\t\t\t\t\toptions: questionDetails.data.options,\r\n\t\t\t\t\tindex: questionDetails.data.index\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tcase 'rating':\r\n\t\t\tcase 'slider': {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttitle: questionDetails.data.title,\r\n\t\t\t\t\ttype: questionType,\r\n\t\t\t\t\tmax: questionDetails.data.max,\r\n\t\t\t\t\tstep: questionDetails.data.step,\r\n\t\t\t\t\tindex: questionDetails.data.index\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tconsole.error(err);\r\n\t\treturn null;\r\n\t}\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}