{"ast":null,"code":"var _jsxFileName = \"E:\\\\Desktop\\\\\\u684C\\u9762\\\\\\u5DE5\\u4F5C\\\\\\u7F16\\u7A0B\\\\\\u524D\\u7AEF\\\\projext\\\\project\\\\src\\\\pages\\\\draft.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { getUserSurveys } from \"../utils/getUserSurveys\";\nimport { RenderDraftsContext } from \"../components/draftsDisplay/context/drafts\";\nimport RenderDrafts from \"../components/draftsDisplay/renderDrafts\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Draft = () => {\n  _s();\n  // 获取用户保存在草稿的问卷\n  const [drafts, setDrafts] = useState([]);\n  console.log('---------', drafts);\n\n  // 是否存在草稿\n  const [hasDraft, setHasDraft] = useState(false);\n  try {\n    fetch(`http://localhost:1337/api/clients/${localStorage.getItem('token')}`).then(resp => {\n      if (!resp.ok) {\n        throw new Error(`获取用户数据失败: ${resp.status}`);\n      }\n      return resp.json();\n    }).then(data => {\n      console.log('hhhhhh');\n      console.log(data);\n      const surveys = data.data.surveys;\n      if (surveys == null || surveys === '') {\n        setHasDraft(false);\n      } else {\n        setHasDraft(true);\n      }\n    });\n  } catch (err) {\n    console.error(err);\n  }\n  useEffect(() => {\n    getUserSurveys(true).then(r => setDrafts(r));\n  }, [hasDraft]);\n  return /*#__PURE__*/_jsxDEV(RenderDraftsContext.Provider, {\n    value: drafts,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: hasDraft && /*#__PURE__*/_jsxDEV(RenderDrafts, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 18\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 3\n  }, this);\n};\n_s(Draft, \"0isVIjVpz68I47JMHr7Yc//KRso=\");\n_c = Draft;\nexport default Draft;\nvar _c;\n$RefreshReg$(_c, \"Draft\");","map":{"version":3,"names":["React","useEffect","useState","getUserSurveys","RenderDraftsContext","RenderDrafts","jsxDEV","_jsxDEV","Draft","_s","drafts","setDrafts","console","log","hasDraft","setHasDraft","fetch","localStorage","getItem","then","resp","ok","Error","status","json","data","surveys","err","error","r","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["E:/Desktop/桌面/工作/编程/前端/projext/project/src/pages/draft.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport {getUserSurveys} from \"../utils/getUserSurveys\";\r\nimport {RenderDraftsContext} from \"../components/draftsDisplay/context/drafts\";\r\nimport RenderDrafts from \"../components/draftsDisplay/renderDrafts\";\r\n\r\nconst Draft = () => {\r\n\t// 获取用户保存在草稿的问卷\r\n\tconst [drafts, setDrafts] = useState([]);\r\n\tconsole.log('---------', drafts);\r\n\r\n\r\n\t// 是否存在草稿\r\n\tconst [hasDraft, setHasDraft] = useState(false);\r\n\ttry {\r\n\t\tfetch(`http://localhost:1337/api/clients/${localStorage.getItem('token')}`)\r\n\t\t\t.then(resp => {\r\n\t\t\t\tif (!resp.ok) {\r\n\t\t\t\t\tthrow new Error(`获取用户数据失败: ${resp.status}`);\r\n\t\t\t\t}\r\n\t\t\t\treturn resp.json();\r\n\t\t\t})\r\n\t\t\t.then(data => {\r\n\t\t\t\tconsole.log('hhhhhh')\r\n\t\t\t\tconsole.log(data);\r\n\t\t\t\tconst surveys = data.data.surveys;\r\n\t\t\t\tif (surveys == null || surveys === '') {\r\n\t\t\t\t\tsetHasDraft(false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetHasDraft(true);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t} catch (err) {\r\n\t\tconsole.error(err);\r\n\t}\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tgetUserSurveys(true).then(r => setDrafts(r));\r\n\t}, [hasDraft])\r\n\r\n\r\n\treturn (\r\n\t\t<RenderDraftsContext.Provider value={drafts}>\r\n\t\t\t<div>\r\n\t\t\t\t{hasDraft && <RenderDrafts/>}\r\n\t\t\t</div>\r\n\t\t</RenderDraftsContext.Provider>\r\n\t);\r\n};\r\n\r\nexport default Draft;\r\n\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAChD,SAAQC,cAAc,QAAO,yBAAyB;AACtD,SAAQC,mBAAmB,QAAO,4CAA4C;AAC9E,OAAOC,YAAY,MAAM,0CAA0C;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpE,MAAMC,KAAK,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACnB;EACA,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EACxCU,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEH,MAAM,CAAC;;EAGhC;EACA,MAAM,CAACI,QAAQ,EAAEC,WAAW,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EAC/C,IAAI;IACHc,KAAK,CAAC,qCAAqCC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CACzEC,IAAI,CAACC,IAAI,IAAI;MACb,IAAI,CAACA,IAAI,CAACC,EAAE,EAAE;QACb,MAAM,IAAIC,KAAK,CAAC,aAAaF,IAAI,CAACG,MAAM,EAAE,CAAC;MAC5C;MACA,OAAOH,IAAI,CAACI,IAAI,CAAC,CAAC;IACnB,CAAC,CAAC,CACDL,IAAI,CAACM,IAAI,IAAI;MACbb,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;MACrBD,OAAO,CAACC,GAAG,CAACY,IAAI,CAAC;MACjB,MAAMC,OAAO,GAAGD,IAAI,CAACA,IAAI,CAACC,OAAO;MACjC,IAAIA,OAAO,IAAI,IAAI,IAAIA,OAAO,KAAK,EAAE,EAAE;QACtCX,WAAW,CAAC,KAAK,CAAC;MACnB,CAAC,MAAM;QACNA,WAAW,CAAC,IAAI,CAAC;MAClB;IACD,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOY,GAAG,EAAE;IACbf,OAAO,CAACgB,KAAK,CAACD,GAAG,CAAC;EACnB;EAGA1B,SAAS,CAAC,MAAM;IACfE,cAAc,CAAC,IAAI,CAAC,CAACgB,IAAI,CAACU,CAAC,IAAIlB,SAAS,CAACkB,CAAC,CAAC,CAAC;EAC7C,CAAC,EAAE,CAACf,QAAQ,CAAC,CAAC;EAGd,oBACCP,OAAA,CAACH,mBAAmB,CAAC0B,QAAQ;IAACC,KAAK,EAAErB,MAAO;IAAAsB,QAAA,eAC3CzB,OAAA;MAAAyB,QAAA,EACElB,QAAQ,iBAAIP,OAAA,CAACF,YAAY;QAAA4B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxB;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACuB,CAAC;AAEjC,CAAC;AAAC3B,EAAA,CA3CID,KAAK;AAAA6B,EAAA,GAAL7B,KAAK;AA6CX,eAAeA,KAAK;AAAC,IAAA6B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}